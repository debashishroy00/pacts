{
  "permissions": {
    "allow": [
      "Bash(git add backend/utils/ulog.py backend/runtime/discovery.py backend/storage/selector_cache.py metrics_collector.py)",
      "Bash(git add backend/utils/ulog.py backend/runtime/runtime_profile.py backend/runtime/discovery.py backend/storage/selector_cache.py backend/agents/executor.py metrics_collector.py)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat(week8): Phase A + Observability - Unified logging shim (ulog)\n\nWeek 8 EDR observability implementation - structured log tags for metrics collection.\n\n## 1. Unified Logger (NEW)\n**File**: backend/utils/ulog.py\n- Structured logging for EDR metrics collection\n- Tags: [PROFILE], [DISCOVERY], [CACHE], [READINESS], [HEAL], [RESULT]\n- Format: [TAG] k=v k=v ...\n- Zero-risk shim, no behavioral changes\n\n## 2. Profile Logging\n**File**: backend/runtime/runtime_profile.py\n- Added ulog.profile(using=STATIC|DYNAMIC, detail=signal)\n- Emits profile detection with reason (sf-lightning, react, angular, or URL)\n- Logs on override, auto-detect, and default fallback paths\n\n## 3. Readiness Logging\n**File**: backend/agents/executor.py\n- Added ulog.readiness(stage=X) to 3-stage gate\n- Stages: dom-idle, element-visible, app-ready-hook\n- Emits at start of each readiness stage\n\n## 4. Cache Logging\n**File**: backend/storage/selector_cache.py\n- Added ulog.cache_saved(selector, strategy) on stable writes\n- Added ulog.cache_skipped(selector, reason) on volatile rejections\n- Complements existing Week 8 stable-only policy\n\n## 5. Metrics Collector\n**File**: metrics_collector.py\n- Fixed ROOT path for Windows (was /mnt/data, now project root)\n- Parses structured logs from runs/<app>/*.log\n- Generates phase_a_validation_summary.md + .json\n\n## Log Output Example\n```\n[PROFILE] using=DYNAMIC detail=sf-lightning\n[READINESS] stage=dom-idle info=-\n[READINESS] stage=element-visible info=-\n[READINESS] stage=app-ready-hook info=-\n[CACHE] status=üíæ_SAVED selector=input[name=\"q\"] strategy=name\n[CACHE] status=‚è©_SKIPPED reason=(VOLATILE) selector=role=button[name=\"new\"]\n```\n\n## Next Steps (Remaining Patches)\n- Discovery logging: Add ulog.discovery() to each tier return in discovery.py\n- Result logging: Add ulog.result(passed=True|False) to test completion\n\n## Validation Ready\nWith Profile, Readiness, and Cache logging in place, we can:\n1. Run test suites with structured logs\n2. Collect metrics via metrics_collector.py\n3. Generate EDR KPI reports (cold-run pass rate, stable selector ratio, etc.)\n\nü§ñ Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")"
    ],
    "deny": [],
    "ask": []
  }
}
